{% extends "base.html" %}

{% load i18n %}

{% block extrahead %}
	<script src='https://api.tiles.mapbox.com/mapbox.js/v1.6.2/mapbox.js'></script>
	<link href='https://api.tiles.mapbox.com/mapbox.js/v1.6.2/mapbox.css' rel='stylesheet' />
{% endblock %}

{% block content %}
<h2>{% trans "Trip" %} {{ trip.title }}</h2>
{% if trip.owner == user %}
	<p><a href="{% url 'trips:edit' trip.id %}" data-ajax="false" >Edit trip</a></p>
{% endif %}
<p>{{ trip.trip_begin }} - {{ trip.trip_end }}</p>
<p>{{ trip.description }}</p>

{% if trip.gpx_log %}
	<script src='//api.tiles.mapbox.com/mapbox.js/plugins/leaflet-omnivore/v0.0.1/leaflet-omnivore.min.js'></script>
	<div id='map'></div>

	<script>
	var map = L.mapbox.map('map', 'examples.map-9ijuk24y');

	var runLayer = omnivore.gpx('{{ trip.gpx_log.url }}')
		.on('ready', function() {
			map.fitBounds(runLayer.getBounds());
		}).addTo(map);
	</script>
{% endif %}

{% endblock %}
